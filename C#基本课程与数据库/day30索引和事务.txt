			索引

什么是索引?
   索引:是SQL Server中编排数据/查询数据的内部方法
   说明:1.编排----页数据是按照聚集索引排序的
索引的作用?
SQL Server 存储和访问数据的方法
存储数据方法
1.数据行存储在页中,当行插满页的时候,数据页拆分
2.数据行的存储是无序的,数据页也是无序的,数据页并不是通过链表连接
访问数据方法
1.扫描表中所有的数据页,称为表扫描
   开始于表的起点,一页页地扫描表中的所有行;提取符合查询标准的行
2.使用指向页上数据的索引
   遍历索引树结构,找到查询所请求的列;只提取符合查询标准的列.

索引类型
1.唯一索引:唯一索引不允许两行具有想再的索引值
2.主键索引:主键索引是唯一索引的特殊类型,主键索引要求主键中的每个值是唯一的,并且不能为空,为表定义一个主键时系统将自动创建主键索引
3.组合索引允许在创建索引时使用两列或更多的列

1.聚集索引:索引页的键值的逻辑(索引)顺序与表中各行的物理顺序相同,每个表只能有一个
2.非聚集索引:非聚集索引指定表的逻辑顺序.数据存储在一个位置,索引存储在另一个位置,索引中包含指向数据存储位置的指针.
  聚集索引和非聚集索引可以创建为唯一索引或组合索引

创建索引
语法:create [unique] [clustered|nonclustered]
     index index_name on table_name (column_name....)
     [with fillfactor=x]
unique 指示是否为唯一
fillfactor表示填充因子,指定一个0到100之间的值,该值指示索引页填满的空间所占的百分比
1)填充因子是在创建索引时指定的,指定了创建索引后要在页中输入数据的量,它用来在各个索引页上预留一定的比例的可用空间,以供将来进行数据扩充时使用
2)如果无须再修改数据,可以指定填充因子100,这样将完全占满索引页,不预留空间,因而所占用的存储空间最少.
3)如果需要频繁地修改表中的数据,则应指定一个较小的填充因子,以便在数据页中保留更多的空白空间

设置表强制使用哪种索引
select * form 表 [with (index= 索引名)] where 条件

删除索引
drop index 表名.索引名

索引的缺点
1.数据库需要更多的存储空间
2.操作数据需要更多的处理时间,因为它们需要对索引进行更新

创建索引的指导原则
以下情况建议使用
   1.频繁查询的列----where 后面的列
   2.经常排序的列----order by 后面的列
以下情况不建议使用
   1.表中只有几个列,几行数据,不适合
   2.某列操作特别多,查询特别少,不适合建索引(还要额外的维护索引)
   3.重复数据特别多

		事务
-----------------------------------			
SQL Server 事务是SQL Server提供的一种高级约束机制,用于强制完整性的
事务可以定义更为复杂的约束,可以包含复杂的SQL语句
通常用于在多表之间执行特殊的规则约束,
事务是一组不可分割的逻辑的单元所组成的操作命令,作为整体一起提交给服务器,要么都执行,要么都不执行

事务必须具备以下四个特性(ACID)
1.原子性:事务的各步操作是不可再少的要么都执行,反之易然
2.一致性:事务使数据库从一个一致状态到另一个一致状态
         也就是:当事务无成后,数据还是一致的
3.隔离性:事务是独立的,事务之间不能相互依赖或影响
4.持久性:当事务无成后,结果永久保存
说明:事务完成指得是
	1)提交事务 commit transcation
	2)回滚事务 rollback transcation

事务分类:
  1.自动提交事务:SQL Server 的默认模式,每一个T-SQL语句都是一个事务,不用显示开始或结束事务
  2.显示事务[用户自定义的]用begin tran[saction]开始事务,以commit或rollback transcation结束事务
  3.隐式事务,用set implicit_transcations on 将隐式事务开户
  在上一个事务执行完成则事务自动开始,但是必须用commit或rollback结束事务
  注意:隐式事务打开时,只要没有commit 或rollback,所有语句都是一个事务.  用set implicit_transcations off关闭隐式事务
































